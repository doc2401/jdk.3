<HTML>

<HEAD>

   <TITLE>Java IDL: The "Hello World" Example</TITLE>

<!-- Changed by: carson 11/2000 -->

   <X-SAS-WINDOW TOP=42 BOTTOM=477 LEFT=4 RIGHT=534>

</HEAD>

<BODY BGCOLOR="#FFFFFF">



<H1 ALIGN=CENTER>Java IDL: The "Hello World" Example</H1>

<HR>

<P>This document is a high-level overview of how to create a complete CORBA (Common Object 
Request Broker Architecture) application using IDL (Interface Definiton Language) to 
define 
interfaces and the Java IDL compiler to generate stubs and skeletons.  For more 
information 
on the development process, and a more detailed tutorial on creating a CORBA application 
using IDL, link to <A HREF="GShome.html">Getting Started with Java IDL: The Hello World 
Tutorial</A>.  You can also create CORBA application by defining the interfaces in the 
Java 
programming language.  For more information and a tutorial on this development process, 
link to <A HREF="../rmi-iiop/index.html">Java RMI-IIOP documentation</A>.

<P>Folow the link to <A HREF="jidlChanges.html">Changes is Java IDL between JDK 1.2 and 
J2SE 1.3</A> for an explanation of the changes that have occurred in  Java IDL  between 
releases.


<P>This document contains:
<UL>

   <LI>The <A href="#IDL">IDL</A> for a simple "Hello World" program

   

   <LI>A <A href="#server">transient server</A> that creates an object and 

   registers it in a naming context

   

   <LI>An <A HREF="#application">application client</A> and an applet that know the 
object's name, retrieve a reference for it from the naming context, and invokes the object

   

   <LI>An  that does the same
   <LI><A href="#instructions">Instructions</A> for compiling and running 

the example

   </UL>



<P>






<!--************IDL*************-->



<A name="IDL">

<H2>Defining the Interface (<code>Hello.idl</code>)</H2></A>



<P>The following example OMG IDL describes a CORBA object whose single

<TT>sayHello()</TT> operation returns a string.</P>



<PRE>
module HelloApp
{
    interface Hello
    {
        string sayHello();
    };
};
</PRE>


<A name="interop">
<B>NOTE:</B> When writing code in OMG IDL,
      do not use an interface name as the name of a module. 
      Doing so runs the risk of getting inconsistent results when 
      compiling with tools from different vendors, thereby jeopardizing
      the code's portability.  For example, 
      code containing the same names could be compiled with the IDL to Java 
      compiler from Sun Microsystems and get one result. 
      The same code compiled with another vendor's IDL to Java 
      compiler could produce a different result. 
<p>

To complete the application, you simply provide the server (<code>HelloServer.java</code>) 
and client (<code>HelloClient.java</code> or <code>HelloApplet.java</code>) 
implementations.



<!--************TRANSIENT SERVER*************-->



<A NAME="server">

<H2>Implementing the Server (<code>HelloServer.java</code>)</H2></A>



<P>The example server consists of two classes, the servant and the

server. The servant, <TT>HelloServant</TT>, is the implementation of

the <TT>Hello</TT> IDL interface; each <TT>Hello</TT> instance is implemented

by a <TT>HelloServant</TT> instance. The servant is a subclass of

<TT>_HelloImplBase</TT>, which 

is generated by the <TT>idlj</TT> compiler from the example IDL.

The servant contains one method for each IDL operation, in this

example, just the <TT>sayHello()</TT> method. Servant methods are

just like ordinary Java methods; the extra code to deal with the ORB,

with marshaling arguments and results, and so on, is provided by the

server and the stubs.</P>



<P>The server class has the server's <TT>main()</TT> method, which:

</P>
<UL>

   <LI>Creates an ORB instance

   <LI>Creates a servant instance (the implementation of one CORBA

   <TT>Hello</TT> object) and tells the ORB about it


   <LI>Gets a CORBA object reference for a naming context in which to

   register the new CORBA object


   <LI>Registers the new object in the naming context under the name "Hello"


   <LI>Waits for invocations of the new object
</UL>

<P>For more discussion of the code, see the detailed tutorial topic <A 
HREF="tutorial/GSserver.html">Getting Started with Java IDL: Developing a Hello World 
Server</A>.

<PRE>// <A HREF="examplelicense.html">Copyright and License</A> 

import HelloApp.*;
import org.omg.CosNaming.*;
import org.omg.CosNaming.NamingContextPackage.*;
import org.omg.CORBA.*;
&nbsp;
class HelloServant extends _HelloImplBase 
{
    public String sayHello()
    {
	return "\nHello world !!\n";
    }
}

&nbsp;
public class HelloServer {
&nbsp;
    public static void main(String args[])
    {
	try{
	    // create and initialize the ORB
	    ORB orb = ORB.init(args, null);
&nbsp;
	    // create servant and register it with the ORB
	    HelloServant helloRef = new HelloServant();
	    orb.connect(helloRef);
&nbsp;
	    // get the root naming context
	    org.omg.CORBA.Object objRef = 
		orb.resolve_initial_references("NameService");
	    NamingContext ncRef = NamingContextHelper.narrow(objRef);
&nbsp;
	    // bind the Object Reference in Naming
	    //make sure there are no spaces between ""
	    NameComponent nc = new NameComponent("Hello", "");
	    NameComponent path[] = {nc};
	    ncRef.rebind(path, helloRef);
&nbsp;
	    // wait for invocations from clients
            java.lang.Object sync = new java.lang.Object();
            synchronized (sync) {
                sync.wait();
            }
&nbsp;
	} catch (Exception e) {
	    System.err.println("ERROR: " + e);
	    e.printStackTrace(System.out);
	}
    }
}
&nbsp;</PRE>





<!--************APPLICATION*************-->



<A name="application">

<H2>Implementing the Client Application (<code>HelloClient.java</code>)</H2></A>



<P>The example application client that follows:</P>



<UL>

   <LI>Creates an ORB

   

   <LI>Obtains a reference to the naming context

   

   <LI>Looks up "Hello" in the naming context and receives a reference to that CORBA 
object

   

   <LI>Invokes the object's <TT>sayHello()</TT> operation and prints

   the result

</UL>

<P>For more discussion of the details of the code, link to <A 
HREF="tutorial/GSapp.html">Getting Started with Java IDL: Developing a Client 
Application</A>.


<PRE>// <A HREF="examplelicense.html">Copyright and License</A> 
&nbsp;
import HelloApp.*;
import org.omg.CosNaming.*;
import org.omg.CORBA.*;
&nbsp;
public class HelloClient 
{
    public static void main(String args[])
    {
	try{
	    // create and initialize the ORB
	    ORB orb = ORB.init(args, null);
&nbsp;
            // get the root naming context
            org.omg.CORBA.Object objRef = orb.resolve_initial_references("NameService");
            NamingContext ncRef = NamingContextHelper.narrow(objRef);

            // resolve the Object Reference in Naming
            // make sure there are no spaces between ""
            NameComponent nc = new NameComponent("Hello", "");
            NameComponent path[] = {nc};
            Hello helloRef = HelloHelper.narrow(ncRef.resolve(path));
&nbsp;
	    // call the Hello server object and print results
	    String hello = helloRef.sayHello();
	    System.out.println(hello);
&nbsp;
	} catch (Exception e) {
	    System.out.println("ERROR : " + e) ;
	    e.printStackTrace(System.out);
	}
    }
}

&nbsp;</PRE>



<!--************APPLET*************-->



<A name="applet">

<H2>Implementing the Applet Client (<code>HelloApplet.java</code>)</H2></A>



<P>The example applet client that follows:</P>



<UL>

   <LI>Creates an ORB

   

   <LI>Obtains a reference to the naming context

   

   <LI>Looks up "Hello" in the naming context and receives a reference to that CORBA 
object

   

   <LI>Invokes the object's <TT>sayHello()</TT> operation and prints

   the result

</UL>

<P>For more discussion of the client applet code, link to <A 
HREF="tutorial/GSapplet.html">Getting Started with Java IDL: Developing a Client 
Applet</A>.  



<PRE>// <A HREF="examplelicense.html">Copyright and License</A> 

import HelloApp.*;
import org.omg.CosNaming.*;
import org.omg.CosNaming.NamingContextPackage.*;
import org.omg.CORBA.*;
import java.awt.Graphics;
&nbsp;
public class HelloApplet extends java.applet.Applet 
{
    public void init() {
	try {
	    // create and initialize the ORB
            ORB orb = ORB.init(this, null);

            // get the root naming context
            org.omg.CORBA.Object objRef = 
		        orb.resolve_initial_references("NameService");
            NamingContext ncRef = NamingContextHelper.narrow(objRef);

            // resolve the Object Reference in Naming
            NameComponent nc = new NameComponent("Hello", "");
            NameComponent path[] = {nc};
            Hello helloRef = HelloHelper.narrow(ncRef.resolve(path));

            // call the Hello server object and print results
            message = helloRef.sayHello();
&nbsp;
	} catch (Exception e) {
	    System.out.println("HelloApplet exception: " + e.getMessage());
	    e.printStackTrace(System.out);
        }
    }
&nbsp;

    public void paint(Graphics g) 
    {
	g.drawString(message, 25, 50);
    }
&nbsp;
    String message = "";
}
&nbsp;</PRE>


<P>Once you've written an applet, you need to add it to an HTML page so that you can try 
it out.  You do this by adding an <TT>&lt;APPLET&gt;</TT> tag to the basic HTML shell.  
When you have completed this step, you can run your applet using the Applet Viewer or 
from a J2SE v1.3-enabled Web browser.

<P>The example HTML file, <TT>Tutorial.html</TT>, would look like this:
<P>
<PRE>
&lt;HTML&gt;
&lt;!--Copyright 2000, Sun Microsystems, Inc. --&gt;
&lt;HEAD&gt;
   &lt;TITLE&gt;Getting Started with Java IDL: Running HelloApplet&lt;/TITLE&gt;
   &lt;X-SAS-WINDOW TOP=42 BOTTOM=477 LEFT=4 RIGHT=534&gt;
&lt;/HEAD&gt;
&lt;BODY BGCOLOR="#FFFFFF"&gt;


&lt;H1 ALIGN=CENTER&gt;Running the Hello World Applet&lt;/H1&gt;
&lt;HR&gt;

&lt;P&gt;If all goes well, the applet appears below:

&lt;P&gt;
&lt;APPLET CODE=HelloApplet.class 
        CODEBASE='enter_the_path_to_your_project_directory_here'
        WIDTH=500 
        HEIGHT=300&gt;
&lt;PARAM name="org.omg.CORBA.ORBInitialHost" value=enter_server_machine_name&gt;
&lt;PARAM name="org.omg.CORBA.ORBInitialPort" value=1050&gt;
&lt;/APPLET&gt;


&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE> 


<!--************COMPILING THE EXAMPLES************-->



<A name="instructions">

<H2>Building and Running Hello World</H2></A>

<P>Despite its simple design, the Hello World program lets you learn and
experiment with all the tasks required to develop almost any CORBA program
that uses <A href="jidlGlossary.html#invocation">static invocation</A>.  To run this 
client-server application on your development machine:

<P>When running this example, remember that the default port number is 900.  When using 
Solaris software, you must become root to start a process on a port under 1024.  For this 
reason, we recommend that you use a port number greater than or equal to 1024. The 
<TT>-ORBInitialPort</TT> option is used to override the default port number in this 
example.  The following instructions assume you can use port 1050
for the Java&nbsp;IDL name server. You can substitute a different
port if necessary.  When running these examples on a Windows machine, 
subtitute a backslash (\) in path names.</P>
  
<OL>

<LI>Change to the directory that contains the file <TT>Hello.idl</TT>.
<P>
<LI>Run the IDL-to-Java compiler, <TT>idlj</TT>, on the IDL file to
create stubs and skeletons.<BR>

<PRE>
   idlj -fall  Hello.idl
</PRE>

<P>You must use the <TT>-fall</TT> option with the <TT>idlj</TT> compiler to generate both 
client and server-side bindings.  For more information on the <TT>idlj</TT> options, link 
to <A HREF = "../rmi-iiop/toJavaPortableUG.html">IDL-to-Java compiler options</A>.

<P>The <TT>idlj</TT> compiler generates a number of files.  The actual number of files 
generated depends on the options
selected when the IDL file is compiled.  The generated files provide standard
functionality, so you can
ignore them until it is time to deploy and run your program.
The files generated by the <TT>idlj</TT> compiler for <TT>Hello.idl</TT>, with the 
<TT>-fall</TT> command 
line option, are: 
<P>
<DL>
<DT><TT>_HelloImplBase.java</TT>
<DD>This abstract class is the 
<A href="jidlGlossary.html#server skeleton">server skeleton</A>, 
providing basic CORBA 
functionality for the server. It implements the  <TT>Hello.java</TT> interface. 
The server class <TT>HelloServant</TT> extends <TT>_HelloImplBase</TT>.

<DT><TT>_HelloStub.java</TT>
<DD>This class is the 
<A href="jidlGlossary.html#client stub">client stub</A>, 
providing CORBA functionality for the
client. It implements the <TT>Hello.java</TT> interface.

<DT><TT>Hello.java</TT>
<DD>This interface contains the Java version of our IDL interface. The <TT>Hello.java</TT> 
interface extends
<TT>org.omg.CORBA.Object</TT>, providing standard CORBA object functionality.

<DT><TT>HelloHelper.java</TT>
<DD>This final class provides auxiliary functionality, notably the 
<TT>narrow()</TT> method required to cast CORBA 
<A href="jidlGlossary.html#object reference">object references</A> to their 
proper types.

<DT><TT>HelloHolder.java</TT>
<DD>This final class holds a public instance member of type <TT>Hello</TT>.  
It provides operations for 
<A href="jidlGlossary.html#parameters"><TT>out</TT> and <TT>inout</TT></A> 
arguments, which CORBA allows, but 
which do not map easily to Java's semantics.

<DT><TT>HelloOperations.java</TT>
<DD>This interface contains the single method <TT>sayHello()</TT>. The IDL-to-Java mapping 
puts all of the operations 
defined on the IDL interface into this file, which is shared by both the stubs and 
skeletons.
</DL>

<P>
<LI>Compile the <TT>.java</TT> files, including the stubs and skeletons
(which are in the directory <TT>HelloApp</TT>):
<PRE>
   javac *.java HelloApp/*.java
</PRE>

   <LI>Start the Java IDL Name Server.  To do this from a UNIX command shell, enter:
   <P>   
<PRE>
     tnameserv -ORBInitialPort 1050&
</PRE>
<P>From an MS-DOS system prompt (Windows), enter:
<PRE>
     start tnameserv -ORBInitialPort 1050
</PRE>
   
 <P>Note that <TT>1050</TT> is the port on which you want the name server to run.  If you 
do not specify this, port 900 will be chosen by default.  Also note that when using 
Solaris 
software, you must become root to start a process on a port under 1024.  For this reason, 
we recommend that you use a port number greater than or equal to 1024.<P>
 
<LI>Start the Hello server:
<PRE>
   java HelloServer -ORBInitialHost <em>namerserverhost</em> -ORBInitialPort 1050
</PRE>
<P>Note that <em>nameserverhost</em> is the host on which the IDL name server is running.  
You can omit <TT>-ORBInitialHost</TT> <em>nameserverhost</em> if the name server is 
running 
on the same host as the Hello server.  You can leave out <TT>-ORBInitialPort 1050</TT> if 
the name server is running on the default port.<P>

   <LI>Run the Hello application client or applet from a different shell than the  server:
<UL>  
   <LI>To run the client application,
   <P>
   <OL>
   <LI>From another DOS prompt or shell, type:<P>
   <PRE>   java HelloClient  -ORBInitialHost <em>namerserverhost</em> -ORBInitialPort 1050
</PRE>


<P>Note that <em>nameserverhost</em> is the host on which the IDL name server is running.  
You can omit <TT>-ORBInitialHost</TT> <em>nameserverhost</em> if the name server is 
running 
on the same host as the Hello client.  You can leave out <TT>-ORBInitialPort 1050</TT> if 
the name server is running on the default port.<P>
   </OL>
   
   <LI>To run the applet from the appletviewer,<P>
	<OL>
	<LI>Open another prompt or shell.
	<LI>Change to the applet directory, <TT>HelloApp</TT>.
	<LI>Start the appletviewer and 
    browse <TT>Tutorial.html</TT> by typing:

    <PRE>   appletviewer Tutorial.html</PRE>
    </OL>
    </UL>

</OL>
   <P>When you have finished this tutorial, be sure to shut down the server, or to kill 
the 
server process.  From a DOS prompt, select the window that is running the server and enter 
<TT>Ctrl+C</TT>.  From a Unix shell, find the process, and select Kill.  The server will 
continue to wait for invocations until it is explicitly stopped.


<P><STRONG><a href="tutorial/jidl2machines.html">Running the Hello World Application on 2 
Machines</a></STRONG> describes one way of distributing the simple application across two 
machines - a client and a server.

<CENTER><P><HR>

<TABLE cellpadding=8 cellspacing=4>
<TR>
  <TD ALIGN=CENTER><A href="index.html">Home</A></TD>
</TR></TABLE>


<HR><P><FONT SIZE="-2">

   <A HREF="../../relnotes/SMICopyright.html">Copyright &#169;</A> 1995-2000

   <A HREF="http://www.sun.com/">Sun Microsystems, Inc.</A>

    All Rights Reserved.</FONT></P>

</CENTER>



</BODY>

</HTML>
